apiVersion: template.openshift.io/v1
kind: Template
labels:
  template: dedalus-cl-template
metadata:
  annotations:
    description: |-
      Cluster Logging Instance definition (high-availability)
      For more information about using this template, including OpenShift considerations, see https://github.com/dedalus-enterprise-architect/efk-resources/blob/main/README.md.
    iconClass: icon-d4center
    tags: dedalus-cl-instance,dedalus
  name: dedalus-cl-instance
objects:
- apiVersion: logging.openshift.io/v1
  kind: ClusterLogging
  metadata:
    name: instance
    namespace: openshift-logging
    labels:
      app: cl-logging-dedalus
  spec:
    collection:
      logs:
        type: fluentd
        fluentd: {}
    logStore:
      elasticsearch:
        nodeCount: 3
        proxy:
          resources:
            limits:
              memory: 256Mi
            requests:
              memory: 256Mi
        redundancyPolicy: SingleRedundancy
        resources:
          limits:
            memory: 8Gi
          requests:
            memory: 8Gi
        storage:
          size: 50G
          storageClassName: "${STORAGECLASS}"
      retentionPolicy:
        application:
          maxAge: 7d
        audit:
          maxAge: 2d
        infra:
          maxAge: 2d
      type: elasticsearch
    managementState: Managed
    visualization:
      kibana:
        replicas: 2
      type: kibana
parameters:
- name: STORAGECLASS
  displayName: Storage Class
  description: Type the Storage Class available on the cluster
  required: false
  value: 